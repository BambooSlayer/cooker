#include "inc.h"
#include"nokia_5110.h"

#define PORT_DIR  DDRM=0X1F;//P4DIR |=(BIT2+BIT3+BIT4+BIT0+BIT1)
#define CLK_L   BCLR(4,PTM)//P4OUT|=BIT4
#define CLK_H   BSET(4,PTM)//P4OUT&=~BIT4
#define DIN_L   BCLR(3,PTM)//P4OUT|=BIT3
#define DIN_H   BSET(3,PTM)//P4OUT&=~BIT3
#define DC_L    BCLR(2,PTM)//P4OUT|=BIT2
#define DC_H    BSET(2,PTM)//P4OUT&=~BIT2
#define CE_L    BCLR(1,PTM)//P4OUT|=BIT1
#define CE_H    BSET(1,PTM)//P4OUT&=~BIT1
#define RST_L   BCLR(0,PTM)//P4OUT|=BIT0
#define RST_H   BSET(0,PTM)//P4OUT&=~BIT0


/*--------------------------------------------------------------*/
//	  字体:	LCD1602字体	 8*16 ASCII码表
//取码规则:	低位在前, 列行扫描, 阴码(1-亮, 0-灭)
//查表方法: 要显示的ASCII码-32就可以得到字库码的指针

const uchar nAsciiDot[][16] =              // ASCII
{        0//打开注释要去掉0
	/*{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // - -
	{0x00,0x00,0x38,0xFC,0xFC,0x38,0x00,0x00,0x00,0x00,0x00,0x0D,0x0D,0x00,0x00,0x00}, // -!-
        {0x00,0x0E,0x1E,0x00,0x00,0x1E,0x0E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // -"-
        {0x20,0xF8,0xF8,0x20,0xF8,0xF8,0x20,0x00,0x02,0x0F,0x0F,0x02,0x0F,0x0F,0x02,0x00}, // -#-
        {0x38,0x7C,0x44,0x47,0x47,0xCC,0x98,0x00,0x03,0x06,0x04,0x1C,0x1C,0x07,0x03,0x00}, // -$-
	{0x30,0x30,0x00,0x80,0xC0,0x60,0x30,0x00,0x0C,0x06,0x03,0x01,0x00,0x0C,0x0C,0x00}, // -%-
	{0x80,0xD8,0x7C,0xE4,0xBC,0xD8,0x40,0x00,0x07,0x0F,0x08,0x08,0x07,0x0F,0x08,0x00}, // -&-
	{0x00,0x10,0x1E,0x0E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // -'-
	{0x00,0x00,0xF0,0xF8,0x0C,0x04,0x00,0x00,0x00,0x00,0x03,0x07,0x0C,0x08,0x00,0x00}, // -(-
	{0x00,0x00,0x04,0x0C,0xF8,0xF0,0x00,0x00,0x00,0x00,0x08,0x0C,0x07,0x03,0x00,0x00}, // -)-
	{0x80,0xA0,0xE0,0xC0,0xC0,0xE0,0xA0,0x80,0x00,0x02,0x03,0x01,0x01,0x03,0x02,0x00}, // -*-
	{0x00,0x80,0x80,0xE0,0xE0,0x80,0x80,0x00,0x00,0x00,0x00,0x03,0x03,0x00,0x00,0x00}, // -+-
	{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x1E,0x0E,0x00,0x00,0x00}, // -,-
	{0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // ---
	{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0C,0x0C,0x00,0x00,0x00}, // -.-
	{0x00,0x00,0x00,0x80,0xC0,0x60,0x30,0x00,0x0C,0x06,0x03,0x01,0x00,0x00,0x00,0x00}, // -/-
	{0xF8,0xFC,0x04,0xC4,0x24,0xFC,0xF8,0x00,0x07,0x0F,0x09,0x08,0x08,0x0F,0x07,0x00}, // -0-
	{0x00,0x10,0x18,0xFC,0xFC,0x00,0x00,0x00,0x00,0x08,0x08,0x0F,0x0F,0x08,0x08,0x00}, // -1-
	{0x08,0x0C,0x84,0xC4,0x64,0x3C,0x18,0x00,0x0E,0x0F,0x09,0x08,0x08,0x0C,0x0C,0x00}, // -2-
	{0x08,0x0C,0x44,0x44,0x44,0xFC,0xB8,0x00,0x04,0x0C,0x08,0x08,0x08,0x0F,0x07,0x00}, // -3-
	{0xC0,0xE0,0xB0,0x98,0xFC,0xFC,0x80,0x00,0x00,0x00,0x00,0x08,0x0F,0x0F,0x08,0x00}, // -4-
	{0x7C,0x7C,0x44,0x44,0xC4,0xC4,0x84,0x00,0x04,0x0C,0x08,0x08,0x08,0x0F,0x07,0x00}, // -5-
	{0xF0,0xF8,0x4C,0x44,0x44,0xC0,0x80,0x00,0x07,0x0F,0x08,0x08,0x08,0x0F,0x07,0x00}, // -6-
	{0x0C,0x0C,0x04,0x84,0xC4,0x7C,0x3C,0x00,0x00,0x00,0x0F,0x0F,0x00,0x00,0x00,0x00}, // -7-
	{0xB8,0xFC,0x44,0x44,0x44,0xFC,0xB8,0x00,0x07,0x0F,0x08,0x08,0x08,0x0F,0x07,0x00}, // -8-
	{0x38,0x7C,0x44,0x44,0x44,0xFC,0xF8,0x00,0x00,0x08,0x08,0x08,0x0C,0x07,0x03,0x00}, // -9-
	{0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x06,0x06,0x00,0x00,0x00}, // -:-
	{0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x00,0x00,0x00,0x08,0x0E,0x06,0x00,0x00,0x00}, // -;-
	{0x00,0x80,0xC0,0x60,0x30,0x18,0x08,0x00,0x00,0x00,0x01,0x03,0x06,0x0C,0x08,0x00}, // -<-
	{0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x00,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x00}, // -=-
	{0x00,0x08,0x18,0x30,0x60,0xC0,0x80,0x00,0x00,0x08,0x0C,0x06,0x03,0x01,0x00,0x00}, // ->-
	{0x18,0x1C,0x04,0xC4,0xE4,0x3C,0x18,0x00,0x00,0x00,0x00,0x0D,0x0D,0x00,0x00,0x00}, // -?-
	{0xF0,0xF8,0x08,0xC8,0xC8,0xF8,0xF0,0x00,0x07,0x0F,0x08,0x0B,0x0B,0x0B,0x01,0x00}, // -@-
	{0xE0,0xF0,0x98,0x8C,0x98,0xF0,0xE0,0x00,0x0F,0x0F,0x00,0x00,0x00,0x0F,0x0F,0x00}, // -A-
	{0x04,0xFC,0xFC,0x44,0x44,0xFC,0xB8,0x00,0x08,0x0F,0x0F,0x08,0x08,0x0F,0x07,0x00}, // -B-
	{0xF0,0xF8,0x0C,0x04,0x04,0x0C,0x18,0x00,0x03,0x07,0x0C,0x08,0x08,0x0C,0x06,0x00}, // -C-
	{0x04,0xFC,0xFC,0x04,0x0C,0xF8,0xF0,0x00,0x08,0x0F,0x0F,0x08,0x0C,0x07,0x03,0x00}, // -D-
	{0x04,0xFC,0xFC,0x44,0xE4,0x0C,0x1C,0x00,0x08,0x0F,0x0F,0x08,0x08,0x0C,0x0E,0x00}, // -E-
	{0x04,0xFC,0xFC,0x44,0xE4,0x0C,0x1C,0x00,0x08,0x0F,0x0F,0x08,0x00,0x00,0x00,0x00}, // -F-
	{0xF0,0xF8,0x0C,0x84,0x84,0x8C,0x98,0x00,0x03,0x07,0x0C,0x08,0x08,0x07,0x0F,0x00}, // -G-
	{0xFC,0xFC,0x40,0x40,0x40,0xFC,0xFC,0x00,0x0F,0x0F,0x00,0x00,0x00,0x0F,0x0F,0x00}, // -H-
	{0x00,0x00,0x04,0xFC,0xFC,0x04,0x00,0x00,0x00,0x00,0x08,0x0F,0x0F,0x08,0x00,0x00}, // -I-
	{0x00,0x00,0x00,0x04,0xFC,0xFC,0x04,0x00,0x07,0x0F,0x08,0x08,0x0F,0x07,0x00,0x00}, // -J-
	{0x04,0xFC,0xFC,0xC0,0xF0,0x3C,0x0C,0x00,0x08,0x0F,0x0F,0x00,0x01,0x0F,0x0E,0x00}, // -K-
	{0x04,0xFC,0xFC,0x04,0x00,0x00,0x00,0x00,0x08,0x0F,0x0F,0x08,0x08,0x0C,0x0E,0x00}, // -L-
	{0xFC,0xFC,0x38,0x70,0x38,0xFC,0xFC,0x00,0x0F,0x0F,0x00,0x00,0x00,0x0F,0x0F,0x00}, // -M-
	{0xFC,0xFC,0x38,0x70,0xE0,0xFC,0xFC,0x00,0x0F,0x0F,0x00,0x00,0x00,0x0F,0x0F,0x00}, // -N-
	{0xF0,0xF8,0x0C,0x04,0x0C,0xF8,0xF0,0x00,0x03,0x07,0x0C,0x08,0x0C,0x07,0x03,0x00}, // -O-
	{0x04,0xFC,0xFC,0x44,0x44,0x7C,0x38,0x00,0x08,0x0F,0x0F,0x08,0x00,0x00,0x00,0x00}, // -P-
	{0xF8,0xFC,0x04,0x04,0x04,0xFC,0xF8,0x00,0x07,0x0F,0x08,0x0E,0x3C,0x3F,0x27,0x00}, // -Q-
	{0x04,0xFC,0xFC,0x44,0xC4,0xFC,0x38,0x00,0x08,0x0F,0x0F,0x00,0x00,0x0F,0x0F,0x00}, // -R-
	{0x18,0x3C,0x64,0x44,0xC4,0x9C,0x18,0x00,0x06,0x0E,0x08,0x08,0x08,0x0F,0x07,0x00}, // -S-
	{0x00,0x1C,0x0C,0xFC,0xFC,0x0C,0x1C,0x00,0x00,0x00,0x08,0x0F,0x0F,0x08,0x00,0x00}, // -T-
	{0xFC,0xFC,0x00,0x00,0x00,0xFC,0xFC,0x00,0x07,0x0F,0x08,0x08,0x08,0x0F,0x07,0x00}, // -U-
	{0xFC,0xFC,0x00,0x00,0x00,0xFC,0xFC,0x00,0x01,0x03,0x06,0x0C,0x06,0x03,0x01,0x00}, // -V-
	{0xFC,0xFC,0x00,0x80,0x00,0xFC,0xFC,0x00,0x03,0x0F,0x0E,0x03,0x0E,0x0F,0x03,0x00}, // -W-
	{0x0C,0x3C,0xF0,0xC0,0xF0,0x3C,0x0C,0x00,0x0C,0x0F,0x03,0x00,0x03,0x0F,0x0C,0x00}, // -X-
	{0x00,0x3C,0x7C,0xC0,0xC0,0x7C,0x3C,0x00,0x00,0x00,0x08,0x0F,0x0F,0x08,0x00,0x00}, // -Y-
	{0x1C,0x0C,0x84,0xC4,0x64,0x3C,0x1C,0x00,0x0E,0x0F,0x09,0x08,0x08,0x0C,0x0E,0x00}, // -Z-
	{0x00,0x00,0xFC,0xFC,0x04,0x04,0x00,0x00,0x00,0x00,0x0F,0x0F,0x08,0x08,0x00,0x00}, // -[-
	{0x38,0x70,0xE0,0xC0,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x07,0x0E,0x00}, // -\-
	{0x00,0x00,0x04,0x04,0xFC,0xFC,0x00,0x00,0x00,0x00,0x08,0x08,0x0F,0x0F,0x00,0x00}, // -]-
	{0x08,0x0C,0x06,0x03,0x06,0x0C,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // -^-
	{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20}, // -_-
	{0x00,0x00,0x03,0x07,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // -`-
	{0x00,0xA0,0xA0,0xA0,0xE0,0xC0,0x00,0x00,0x07,0x0F,0x08,0x08,0x07,0x0F,0x08,0x00}, // -a-
	{0x04,0xFC,0xFC,0x20,0x60,0xC0,0x80,0x00,0x08,0x0F,0x07,0x08,0x08,0x0F,0x07,0x00}, // -b-
	{0xC0,0xE0,0x20,0x20,0x20,0x60,0x40,0x00,0x07,0x0F,0x08,0x08,0x08,0x0C,0x04,0x00}, // -c-
	{0x80,0xC0,0x60,0x24,0xFC,0xFC,0x00,0x00,0x07,0x0F,0x08,0x08,0x07,0x0F,0x08,0x00}, // -d-
	{0xC0,0xE0,0xA0,0xA0,0xA0,0xE0,0xC0,0x00,0x07,0x0F,0x08,0x08,0x08,0x0C,0x04,0x00}, // -e-
	{0x40,0xF8,0xFC,0x44,0x0C,0x18,0x00,0x00,0x08,0x0F,0x0F,0x08,0x00,0x00,0x00,0x00}, // -f-
	{0xC0,0xE0,0x20,0x20,0xC0,0xE0,0x20,0x00,0x27,0x6F,0x48,0x48,0x7F,0x3F,0x00,0x00}, // -g-
	{0x04,0xFC,0xFC,0x40,0x20,0xE0,0xC0,0x00,0x08,0x0F,0x0F,0x00,0x00,0x0F,0x0F,0x00}, // -h-
	{0x00,0x00,0x20,0xEC,0xEC,0x00,0x00,0x00,0x00,0x00,0x08,0x0F,0x0F,0x08,0x00,0x00}, // -i-
	{0x00,0x00,0x00,0x00,0x20,0xEC,0xEC,0x00,0x00,0x30,0x70,0x40,0x40,0x7F,0x3F,0x00}, // -j-
	{0x04,0xFC,0xFC,0x80,0xC0,0x60,0x20,0x00,0x08,0x0F,0x0F,0x01,0x03,0x0E,0x0C,0x00}, // -k-
	{0x00,0x00,0x04,0xFC,0xFC,0x00,0x00,0x00,0x00,0x00,0x08,0x0F,0x0F,0x08,0x00,0x00}, // -l-
	{0xE0,0xE0,0x60,0xC0,0x60,0xE0,0xC0,0x00,0x0F,0x0F,0x00,0x0F,0x00,0x0F,0x0F,0x00}, // -m-
	{0x20,0xE0,0xC0,0x20,0x20,0xE0,0xC0,0x00,0x00,0x0F,0x0F,0x00,0x00,0x0F,0x0F,0x00}, // -n-
	{0xC0,0xE0,0x20,0x20,0x20,0xE0,0xC0,0x00,0x07,0x0F,0x08,0x08,0x08,0x0F,0x07,0x00}, // -o-
	{0x20,0xE0,0xC0,0x20,0x20,0xE0,0xC0,0x00,0x40,0x7F,0x7F,0x48,0x08,0x0F,0x07,0x00}, // -p-
	{0xC0,0xE0,0x20,0x20,0xC0,0xE0,0x20,0x00,0x07,0x0F,0x08,0x48,0x7F,0x7F,0x40,0x00}, // -q-
	{0x20,0xE0,0xC0,0x60,0x20,0x60,0xC0,0x00,0x08,0x0F,0x0F,0x08,0x00,0x00,0x00,0x00}, // -r-
	{0x40,0xE0,0xA0,0x20,0x20,0x60,0x40,0x00,0x04,0x0C,0x09,0x09,0x0B,0x0E,0x04,0x00}, // -s-
	{0x20,0x20,0xF8,0xFC,0x20,0x20,0x00,0x00,0x00,0x00,0x07,0x0F,0x08,0x0C,0x04,0x00}, // -t-
	{0xE0,0xE0,0x00,0x00,0xE0,0xE0,0x00,0x00,0x07,0x0F,0x08,0x08,0x07,0x0F,0x08,0x00}, // -u-
	{0x00,0xE0,0xE0,0x00,0x00,0xE0,0xE0,0x00,0x00,0x03,0x07,0x0C,0x0C,0x07,0x03,0x00}, // -v-
	{0xE0,0xE0,0x00,0x00,0x00,0xE0,0xE0,0x00,0x07,0x0F,0x0C,0x07,0x0C,0x0F,0x07,0x00}, // -w-
	{0x20,0x60,0xC0,0x80,0xC0,0x60,0x20,0x00,0x08,0x0C,0x07,0x03,0x07,0x0C,0x08,0x00}, // -x-
	{0xE0,0xE0,0x00,0x00,0x00,0xE0,0xE0,0x00,0x47,0x4F,0x48,0x48,0x68,0x3F,0x1F,0x00}, // -y-
	{0x60,0x60,0x20,0xA0,0xE0,0x60,0x20,0x00,0x0C,0x0E,0x0B,0x09,0x08,0x0C,0x0C,0x00}, // -z-
	{0x00,0x40,0x40,0xF8,0xBC,0x04,0x04,0x00,0x00,0x00,0x00,0x07,0x0F,0x08,0x08,0x00}, // -{-
	{0x00,0x00,0x00,0xBC,0xBC,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x0F,0x00,0x00,0x00}, // -|-
        {0x00,0x04,0x04,0xBC,0xF8,0x40,0x40,0x00,0x00,0x08,0x08,0x0F,0x07,0x00,0x00,0x00}, // -}-
	{0x08,0x0C,0x04,0x0C,0x08,0x0C,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // -~-
	{0x80,0xC0,0x60,0x30,0x60,0xC0,0x80,0x00,0x07,0x07,0x04,0x04,0x04,0x07,0x07,0x00} // --*/
};	


const uchar font6x8[][6] = //modified!
{
    { 0x18, 0x3c, 0x7e, 0x7e, 0x3c, 0x18 },    //myspecial
    { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },   // sp
    { 0x00, 0x00, 0x00, 0x2f, 0x00, 0x00 },   // !
    { 0x00, 0x00, 0x07, 0x00, 0x07, 0x00 },   // "
    { 0x00, 0x14, 0x7f, 0x14, 0x7f, 0x14 },   // #
    { 0x00, 0x24, 0x2a, 0x7f, 0x2a, 0x12 },   // $
    { 0x00, 0x62, 0x64, 0x08, 0x13, 0x23 },   // %
    { 0x00, 0x36, 0x49, 0x55, 0x22, 0x50 },   // &
    { 0x00, 0x00, 0x05, 0x03, 0x00, 0x00 },   // '
    { 0x00, 0x00, 0x1c, 0x22, 0x41, 0x00 },   // (
    { 0x00, 0x00, 0x41, 0x22, 0x1c, 0x00 },   // )
    { 0x00, 0x14, 0x08, 0x3E, 0x08, 0x14 },   // *
    { 0x00, 0x08, 0x08, 0x3E, 0x08, 0x08 },   // +
    { 0x00, 0x00, 0x00, 0xA0, 0x60, 0x00 },   // ,
    { 0x00, 0x08, 0x08, 0x08, 0x08, 0x08 },   // -
    { 0x00, 0x00, 0x60, 0x60, 0x00, 0x00 },   // .
    { 0x00, 0x20, 0x10, 0x08, 0x04, 0x02 },   // /
    { 0x00, 0x3E, 0x51, 0x49, 0x45, 0x3E },   // 0
    { 0x00, 0x00, 0x42, 0x7F, 0x40, 0x00 },   // 1
    { 0x00, 0x42, 0x61, 0x51, 0x49, 0x46 },   // 2
    { 0x00, 0x21, 0x41, 0x45, 0x4B, 0x31 },   // 3
    { 0x00, 0x18, 0x14, 0x12, 0x7F, 0x10 },   // 4
    { 0x00, 0x27, 0x45, 0x45, 0x45, 0x39 },   // 5
    { 0x00, 0x3C, 0x4A, 0x49, 0x49, 0x30 },   // 6
    { 0x00, 0x01, 0x71, 0x09, 0x05, 0x03 },   // 7
    { 0x00, 0x36, 0x49, 0x49, 0x49, 0x36 },   // 8
    { 0x00, 0x06, 0x49, 0x49, 0x29, 0x1E },   // 9
    { 0x00, 0x00, 0x36, 0x36, 0x00, 0x00 },   // :
    { 0x00, 0x00, 0x56, 0x36, 0x00, 0x00 },   // ;
    { 0x00, 0x08, 0x14, 0x22, 0x41, 0x00 },   // <
    { 0x00, 0x14, 0x14, 0x14, 0x14, 0x14 },   // =
    { 0x00, 0x00, 0x41, 0x22, 0x14, 0x08 },   // >
    { 0x00, 0x02, 0x01, 0x51, 0x09, 0x06 },   // ?
    { 0x00, 0x32, 0x49, 0x59, 0x51, 0x3E },   // @
    { 0x00, 0x7C, 0x12, 0x11, 0x12, 0x7C },   // A
    { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x36 },   // B
    { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x22 },   // C
    { 0x00, 0x7F, 0x41, 0x41, 0x22, 0x1C },   // D
    { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x41 },   // E
    { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x01 },   // F
    { 0x00, 0x3E, 0x41, 0x49, 0x49, 0x7A },   // G
    { 0x00, 0x7F, 0x08, 0x08, 0x08, 0x7F },   // H
    { 0x00, 0x00, 0x41, 0x7F, 0x41, 0x00 },   // I
    { 0x00, 0x20, 0x40, 0x41, 0x3F, 0x01 },   // J
    { 0x00, 0x7F, 0x08, 0x14, 0x22, 0x41 },   // K
    { 0x00, 0x7F, 0x40, 0x40, 0x40, 0x40 },   // L
    { 0x00, 0x7F, 0x02, 0x0C, 0x02, 0x7F },   // M
    { 0x00, 0x7F, 0x04, 0x08, 0x10, 0x7F },   // N
    { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x3E },   // O
    { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x06 },   // P
    { 0x00, 0x3E, 0x41, 0x51, 0x21, 0x5E },   // Q
    { 0x00, 0x7F, 0x09, 0x19, 0x29, 0x46 },   // R
    { 0x00, 0x46, 0x49, 0x49, 0x49, 0x31 },   // S
    { 0x00, 0x01, 0x01, 0x7F, 0x01, 0x01 },   // T
    { 0x00, 0x3F, 0x40, 0x40, 0x40, 0x3F },   // U
    { 0x00, 0x1F, 0x20, 0x40, 0x20, 0x1F },   // V
    { 0x00, 0x3F, 0x40, 0x38, 0x40, 0x3F },   // W
    { 0x00, 0x63, 0x14, 0x08, 0x14, 0x63 },   // X
    { 0x00, 0x07, 0x08, 0x70, 0x08, 0x07 },   // Y
    { 0x00, 0x61, 0x51, 0x49, 0x45, 0x43 },   // Z
    { 0x00, 0x00, 0x7F, 0x41, 0x41, 0x00 },   // [
    { 0x00, 0x55, 0x2A, 0x55, 0x2A, 0x55 },   // 55
    { 0x00, 0x00, 0x41, 0x41, 0x7F, 0x00 },   // ]
    { 0x00, 0x04, 0x02, 0x01, 0x02, 0x04 },   // ^
    { 0x00, 0x40, 0x40, 0x40, 0x40, 0x40 },   // _
    { 0x00, 0x00, 0x01, 0x02, 0x04, 0x00 },   // '
    { 0x00, 0x20, 0x54, 0x54, 0x54, 0x78 },   // a
    { 0x00, 0x7F, 0x48, 0x44, 0x44, 0x38 },   // b
    { 0x00, 0x38, 0x44, 0x44, 0x44, 0x20 },   // c
    { 0x00, 0x38, 0x44, 0x44, 0x48, 0x7F },   // d
    { 0x00, 0x38, 0x54, 0x54, 0x54, 0x18 },   // e
    { 0x00, 0x08, 0x7E, 0x09, 0x01, 0x02 },   // f
    { 0x00, 0x18, 0xA4, 0xA4, 0xA4, 0x7C },   // g
    { 0x00, 0x7F, 0x08, 0x04, 0x04, 0x78 },   // h
    { 0x00, 0x00, 0x44, 0x7D, 0x40, 0x00 },   // i
    { 0x00, 0x40, 0x80, 0x84, 0x7D, 0x00 },   // j
    { 0x00, 0x7F, 0x10, 0x28, 0x44, 0x00 },   // k
    { 0x00, 0x00, 0x41, 0x7F, 0x40, 0x00 },   // l
    { 0x00, 0x7C, 0x04, 0x18, 0x04, 0x78 },   // m
    { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x78 },   // n
    { 0x00, 0x38, 0x44, 0x44, 0x44, 0x38 },   // o
    { 0x00, 0xFC, 0x24, 0x24, 0x24, 0x18 },   // p
    { 0x00, 0x18, 0x24, 0x24, 0x18, 0xFC },   // q
    { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x08 },   // r
    { 0x00, 0x48, 0x54, 0x54, 0x54, 0x20 },   // s
    { 0x00, 0x04, 0x3F, 0x44, 0x40, 0x20 },   // t
    { 0x00, 0x3C, 0x40, 0x40, 0x20, 0x7C },   // u
    { 0x00, 0x1C, 0x20, 0x40, 0x20, 0x1C },   // v
    { 0x00, 0x3C, 0x40, 0x30, 0x40, 0x3C },   // w
    { 0x00, 0x44, 0x28, 0x10, 0x28, 0x44 },   // x
    { 0x00, 0x1C, 0xA0, 0xA0, 0xA0, 0x7C },   // y
    { 0x00, 0x44, 0x64, 0x54, 0x4C, 0x44 },   // z
    { 0x14, 0x14, 0x14, 0x14, 0x14, 0x14 }    // horiz lines
};



/**********************************************
**名称:write_command(uchar cmd)
**功能：向液晶中写命令
**说明：cmd：要写的命令
**备注:
**日期:2011年2月27日
**********************************************/
void write_command(uchar cmd)
{
     uchar i;
     CE_L;//允许写入数据
     DC_L;//DC=0写入命令
     for(i=0;i<8;i++)
     {
          if(cmd&0x80)
              DIN_H;
          else
              DIN_L;
          CLK_L; //上升沿采样
          cmd<<=1;
          CLK_H;
     }
     CE_H;//禁止写入
}
/**********************************************
**名称:write_data(uchar dat)
**功能：向液晶中写入数据
**说明：dat:待写入的数据
**备注:参考数据手册
**日期:2011年2月27日  
**********************************************/
void write_data(uchar dat)
{
     uchar i;
     CE_L;//
     DC_H;
     for(i=0;i<8;i++)
     {
          if(dat&0x80)
              DIN_H;
          else
              DIN_L;
          CLK_L;
          dat<<=1;
          CLK_H;
     }
     CE_H;
}
/**********************************************
**名称:set_pos(uchar x,uchar y)
**功能：设置RAM地址
**说明：x:0-83
        y:0-5
**备注:参考数据手册
**日期:2011年2月27日  
**********************************************/
void set_pos(uchar x,uchar y)
  {
    write_command(0x40 | y);	
    write_command(0x80 | x);          	
  }
/**********************************************
**名称:LCD_clear(void)
**功能：清屏
**说明：
**备注:
**日期:2011年2月27日
**********************************************/
void LCD_clear(void)
  {
    unsigned int i;
    write_command(0x80);//起始列地址0		
    write_command(0x40);//起始行地址0			

    for (i=0;i<504;i++)
      write_data(0);			
  }
/**********************************************
**名称:LCD_Init(void)
**功能：初始化液晶
**说明：
**备注:
**日期:2011年2月27日
**********************************************/
void LCD_Init(void)
{
     PORT_DIR ;
     RST_L;//复位
     RST_H;
     write_command(0x21);//工作模式, 水平寻址, 扩展指令
     write_command(0x13);//设置偏置系统(BSx) 1:48
     write_command(0xc8);//设置电压VLCD = 3.06 + 0.06*Vop, 对比度调整
     write_command(0x06);//VLCD温度系数2
     write_command(0x20);//工作模式, 水平寻址, 常规指令
     write_command(0x0c);//普通模式
     write_command(0x40);//起始页地址0
     write_command(0x80);//起始列地址0
     LCD_clear(); //清全屏
}
/**********************************************
**名称:display(uchar x,uchar y,uchar c)
**功能：液晶输出字符（6*8字符）
**说明：x:0-83
        y:0-5
	c：待显示的字符
**备注:每行最多只能显示14个字符（6*n<=84)
最多显示6行
**日期:2011年2月27日
**********************************************/
void display_char(uchar x,uchar y,uchar c)
{
     uchar i;
     c-=31; //获取地址指针
     x*=6;//字宽
     set_pos(x,y);//设置显示地址
     for(i=0;i<6;i++)
       write_data(font6x8[c][i]);//写入点阵数据
}
/**********************************************
**名称:display_string(uint x,uint y,uchar *str)
**功能：液晶输出字符串（6*8字符）
**说明：x:0-83
        y:0-5
	str：字符串的首地址
**备注:每行最多只能显示14个字符（6*n<=84)
**日期:2011年2月27日
**********************************************/
void display_string(uint x,uint y,uchar *str)
  {
    while((*str!='\0')&&x<14) 
      {
	   display_char(x++,y,*str++);
            if(x==14)
          {
               x=0;
               y++;
          }
      }
  }
/**********************************************
**名称:dispaly_float(uchar x,uchar y,float f)
**功能：液晶输出浮点数（6*8字符）
**说明：x:0-83
        y:0-5
	f：0-9
**备注:
**日期:2011年2月27日
**********************************************/
void dispaly_float(uchar x,uchar y,float f)
{
  display_char(x,y,'0'+(int)f);
  display_char(x+1,y,'.');
  display_char(x+2,y,'0'+(int)(f*10)%10);
  display_char(x+3,y,'0'+(int)(f*100)%10);
}
/**********************************************
**名称:display_chinese(uchar x,uchar y,const uchar *str)
**功能：显示单个12*16的汉字
**使用zimo221软件
   字体7，宋体
**说明：x:0-5
        y:0-2
	str：汉字的首地址
**备注:每行最多只能显示6个汉字(n*16<=84)
       显示4行
**日期:2011年2月27日
**********************************************/
#define  word_width 12//字宽
#define  word_height 2//字高,2个字，16位
#define  word_byte 24//24为字节数，即一个12*16汉字需要24个字节
void display_chinese(uchar x,uchar y, const uchar *str)
{
     uchar i,j;
     x*=word_width;//字宽
     y*=word_height;//两行显示
     for(i=0;i<2;i++)
     {
          set_pos(x,y+i);//设置显示的地址
          for(j=0;j<12;j++)
          {
               write_data(str[j+i*12]);
          }
     }  
}
/**********************************************
**名称:display_chinese_string(uchar x,uchar y,uchar n,const uchar *str)
**功能：输出一串12*16的汉字
**说明：x:0-4
        y:0-2
	n:要显示汉字的个数
	str：汉字的首地址
**备注:每行最多只能显示5个汉字(n*16<=84)
**日期:2011年2月27日
**********************************************/
/*void display_chinese_string(uchar x,uchar y,uchar n,const uchar *str)
{
     uchar i;
     for(i=0;i<n;i++)
     {
          display_chinese(x++,y,str+i*word_byte);//24为字节数，即12*16汉字需要24个字节
     }
}*/
void display_chinese_string(uchar x,uchar y, uchar start, uchar n,const uchar *str)
{
     uchar i;
     if(start !=0)
     {
       str=str+start*word_byte;
     }
     for(i=0;i<n;i++)
     {
          display_chinese(x++,y,str+i*word_byte);
          if(x==7)
          {
               x=0;
               y++;
          }
     }
}
/**********************************************
**名称:show_char(uchar x,uchar y,uchar c)
**功能：在任意位置输出一个8*16的ASCII字符
**说明：x:0-9
        y:0-2
	c：字符的首地址
**备注:每行最多只能显示10个字符(n*8<=84)
**日期:2011年2月27日
**********************************************/
void show_char(uchar x,uchar y,uchar c)
{
     uchar i,j;
     c-=32;//地址
     x*=8;//字宽
     y*=2;//两行显示
     for(i=0;i<2;i++)
     {
          set_pos(x,y+i);//设置地址
          for(j=0;j<8;j++)
             write_data(nAsciiDot[c][j+8*i]);
     }
}
/**********************************************
**名称:show_string(uchar x,uchar y,uchar *str)
**功能：在任意位置输出一串8*16的ASCII字符
**说明：x:0-9
        y:0-2
	*str：字符串的首地址
**备注:每行最多只能显示10个字符(n*8<=84)
**日期:2011年2月27日
**********************************************/
void show_string(uchar x,uchar y,uchar *str)
{
     while(*str!='\0')
     {
          show_char(x++,y,*str++);
     }
}
/**********************************************
**名称:draw_dot(uchar x,uchar y)
**功能：在任意位置打一个点
**说明：x:0-83
        y:0-47
**备注:
**日期:2011年2月27日
**********************************************/
void draw_dot(uchar x,uchar y) //打点函数
{
     uchar y1,y2;
     y1=y/8; //判断是那个字节
     y2=y%8;//判断是这个字节的那个位
     set_pos(x,y1);//设置打点的地址
     write_data(0x01<<y2);//低位在前
}
/**********************************************
**名称:draw_lineX(uchar x,uchar y1,uchar y2)
**功能：在任意位置画一条垂线
**说明：x:0-83
        y:0-47
**备注:
**日期:2011年2月27日
**********************************************/
void draw_lineX(uchar x,uchar y1,uchar y2) 
{
      uchar sec0;
    uchar sec1;
    uchar mod0,mod1,play1,play;
    uchar temp,i;
     if(y1>y2)//y1>y2交换这两个数
     {
          temp=y1;
          y1=y2;
          y2=temp;
     }
//     for(y1=y1;y1<y2;y1++)
//       draw_dot(x,y1); //将这些点显示出来
   
   
     play=0x01;
     sec0=y1/8;
     mod0=y1%8;
     
     sec1=y2/8;
     mod1=y2%8;
   
     for(i=0;i<mod0;i++)//初始化play
     {
       play=play<<1;
     }
     play1=play;
     switch(sec1-sec0)
     {
     case 0:
       set_pos(x,sec0);
       while(mod0 != mod1)
       {        
         mod0=mod0+1;
         play=play<<1;
         play1=play1+play;
       }
       write_data(play1);
       break;
       
     case 1:
       set_pos(x,sec0);
       while(mod0 <= 0x07)
       {        
         mod0=mod0+1;
         play=play<<1;
         play1=play1+play;
       }
       write_data(play1);
       
       set_pos(x,sec1);
       play=0x01;
       play1=play;
       while(mod1 > 0)
       {        
         mod1=mod1-1;
         play=play<<1;
         play1=play1+play;
       }
       write_data(play1);
       break;
       
     default:
       set_pos(x,sec0);
       while(mod0 < 0x07)
       {        
         mod0=mod0+1;
         play=play<<1;
         play1=play1+play;
       }
       write_data(play1);
       
       while(sec0<sec1-1)
       {
         i=1;
         set_pos(x,sec0+i);
         write_data(0xff);
         sec0++;
       }
       
       set_pos(x,sec1);
       play=0x01;
       play1=play;
       while(mod1 > 0)
       {        
         mod1=mod1-1;
         play=play<<1;
         play1=play1+play;
       }
       write_data(play1);

       
            
     }
}
/**********************************************
**名称:draw_line(uchar x1,uchar x2,uchar y)
**功能：在任意位置输出一条横线
**说明：x1 x2:0-83
        y:0-47
**备注:
**日期:2011年2月27日
**********************************************/
void draw_lineY(uchar x1,uchar x2,uchar y) 
{
     uchar temp;
     if(x1>x2)//若x1>x2交换两数
     {
        temp=x1;
        x1=x2;
        x2=temp;
     }
     for(;x1<x2;x1++)
       draw_dot(x1,y);
}
/**********************************************
**名称:draw_line(int x1,int y1,int x2,int y2)
**功能：输出任意一条直线
**说明：x1 x2:0-83
        y1 y2:0-47
**备注:
**日期:2011年2月27日
**********************************************/
void draw_line(int x1,int y1,int x2,int y2) //两点之间画任意直线
{
     int x,y,dx,dy,s1,s2,temp,status,p,i;
     x=x1;
     y=y1;
     if(x1>x2) //判断x1,x2的大小
     {
          dx=x1-x2; //
          s1=-1; //x的增量为-1
     }
     else
     {
          dx=x2-x1;
          s1=1; //x的增量为1
     }
     if(y1>y2)
     {
          dy=y1-y2;
          s2=-1;//y的增量为-1
     }
     else
     {
          dy=y2-y1;
          s2=1; //y的增量为1
     }
     if(dx<dy) //靠近y轴，用y来表示x
     {
          temp=dx;
          dy=dx;//x是y的函数
          dx=temp;
          status=1;//表示靠近Y轴
     }
     else
       status=0;//表示靠近x轴
     
     p=2*dy-dx; //使用Bresenhan算法
     
     for(i=1;i<dx;i++)
     {
          draw_dot(x,y); //画起点
          if(p>0)
          {
              if(status==0)//靠近x轴
                  y+=s2;
              else
                  x+=s1;
              p=p-2*dx;
          }
          if(status==0)
              x=x+s1;
          else
              y=y+s2;
          p=p+2*dy;
     }
     
}
/**********************************************
**名称:draw_circle(uchar x0,uchar y0,uchar r)
**功能：在任意位置画圆
**说明：x0:0-83
        y0:0-47
        r:圆的半径
**备注:
**日期:2011年2月27日
**********************************************/
void draw_circle(uchar x0,uchar y0,uchar r)
{
int a,b;
int di;
a=0;
b=r;
di=3-2*r;             //判断下个点位置的标志
while(a<=b)
{
  draw_dot(x0-b,y0-a);             //3           
  draw_dot(x0+b,y0-a);             //0           
  draw_dot(x0-a,y0+b);             //1       
  draw_dot(x0-b,y0-a);             //7           
  draw_dot(x0-a,y0-b);             //2             
  draw_dot(x0+b,y0+a);             //4               
  draw_dot(x0+a,y0-b);             //5
  draw_dot(x0+a,y0+b);             //6 
  draw_dot(x0-b,y0+a);             
  a++;
  ///使用Bresenham算法画圆   
  if(di<0)
  di +=4*a+6;
  else
  {
    di +=10+4*(a-b);   
    b--;
  } 
  draw_dot(x0+a,y0+b);
  }
}

void Display_num(uchar x,uchar y,uint num)
{
  uchar ge,shi,bai,qian;
  ge=num%10;
  shi=num/10%10;
  bai=num/100%10;
  qian=num/1000;

  display_char(x,y,0x30+qian);
  display_char(x+1,y,0x30+bai);
  display_char(x+2,y,0x30+shi);
  display_char(x+3,y,0x30+ge);
}

void Display_f(uchar x,uchar y,uint num)
{
  uchar ge,shi,bai,qian;
  ge=num%10;
  shi=num/10%10;
  bai=num/100%10;
  qian=num/1000;

  display_char(x,y,0x30+qian);
  display_char(x+1,y,0x30+bai);
  display_char(x+2,y,0x30+shi);
  display_char(x+3,y,'.');
  display_char(x+4,y,0x30+ge);
}

void Display_signednum(uchar x,uchar y,int num)
{
  uchar ge,shi,bai,qian,sig;
  if(num>=0)
  {
    ge=num%10;
    shi=num/10%10;
    bai=num/100%10;
    qian=num/1000;
    sig = '+';
  } else
  {
    num = ~num+0x0001;
    ge=num%10;
    shi=num/10%10;
    bai=num/100%10;
    qian=num/1000;
    sig = '-';
  }

  display_char(x,y,sig);
  display_char(x+1,y,0x30+qian);
  display_char(x+2,y,0x30+bai);
  display_char(x+3,y,0x30+shi);
  display_char(x+4,y,0x30+ge);
}





